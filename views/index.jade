doctype html
html
  head
    meta(charset='utf-8')
    title HDFS Web UI
    link(rel='icon', type='image/vnd.microsoft.icon', href='favicon.ico')
    link(rel='shortcut icon', type='image/x-icon', href='favicon.ico')
    link(rel='stylesheet', href='vendors/bootstrap/css/bootstrap.min.css')
    link(rel='stylesheet', href='resources/webapp.css')
    meta(name="viewport", content="width=device-width, initial-scale=1")
    script(type='text/javascript', src='vendors/jquery-1.11.1.min.js')
    script(type='text/javascript', src='vendors/bootstrap/js/bootstrap.min.js')
    script
      :coffee
        $().ready ->
          $('#successLogin').hide()
          console.log 'ready'
          $('#login').submit (e) ->
            # TODO: validation
            $this = $(this)
            user =
              username: $('#login-username').val()
              password: $('#login-password').val()
              button: $('#btn').val()
            console.log 'user', user
            e.preventDefault()
            $.post "/login", user, (data) ->
              console.log 'data', data
              if data.success is true
                $('#signin').hide()
                if data.mode is 'login'
                  $('#loginText').text "Successfully logged in : Username: "+data.username+" - Password: "+data.password
                else
                  $('#loginText').text "Successfully signed in : Username: "+data.username+" - Password: "+data.password
                $('#successLogin').show()
              else
                if data.reason is 'wrong login'
                  alert 'Mauvais user ou mot de passe'
                  location.reload()
                else if data.reason is 'already in database'
                  alert 'Already in database'
                  location.reload()
            , 'json'

  body

    div#signin
      form#login(action="/login", method="post", role="form")
        table
          tr.form-group
            th
              label(for="login-username") Username
            td
              input#login-username.form-control(type='text', name="username")
          tr.form-group
            th
              label(for="login-password") Password
            td
              input#login-password.form-control(type='password', name="password")
          tr.form-group
            th
            td
              //- button.btn.btn-primary(type='button') Login
              //- button.btn.btn-default(type='button') Signin
              input.btn.btn-primary#btn(type='submit', value="Login")
              input.btn.btn-default(type='submit', value="Signin",onclick="$('#btn').val('Signin')")
    div#successLogin
      p#loginText
